<?php 
include "inc.koneksi.php";
$id =0;
$nama = '';
$deskripsi = '';

if(isset($_POST['btnSubmit'])){	
    $nama = $_POST['nama'];	
	$deskripsi = $_POST['deskripsi'];	
	$sql = '';
	$message ='';
	if(isset($_GET['id'])){
		$id =  $_GET['id'];
		$sql = "UPDATE tblCategory SET Nama ='$nama',
		        Deskripsi = '$deskripsi'
				WHERE IDCategory = $id";
		$message ='Data berhasil diubah!';
	}
	else{	
		$sql = "INSERT INTO tblCategory(Nama, Deskripsi) 
		            values ('$nama', '$deskripsi')";
		$message ='Data berhasil ditambahkan!';					
	}			
	$result = mysql_query($sql) or die(mysql_error());
	if($result){
		echo "<script> alert('$message'); </script>";
		echo '<META HTTP-EQUIV="Refresh" Content="0; URL=index.php?p=categorylist">'; 				
	}
	else{
		echo "<script> alert('Proses gagal. Silakan ulangi'); </script>";	
	}			
}
else if(isset($_GET['id'])){	
	$id =  $_GET['id'];
	$queryOne = "SELECT * FROM tblCategory WHERE IDCategory='$id'";
	$resultOne = mysql_query($queryOne) or die(mysql_error());
	
	if(mysql_num_rows($resultOne) == 1){
		$data = mysql_fetch_assoc($resultOne);
		$idcategory = $data['IDCategory'];				
		$nama = $data['Nama'];				
		$deskripsi = $data['Deskripsi'];				
	}	
}
?>
<div class="container">  
<div class="span7">			
  <h4 class="title"><span class="text"><strong>Category</strong></span></h4>
    <form action="" method="post">
	<table class="table" border="0">
	<tr>
	<td>ID Category</td>
	<td>:</td>
	<td><input type="text" class="form-control" id="idcategory" name="idcategory" value="<?php echo $idcategory; ?>"></td>
	</tr>	
	<tr>
	<td>Nama</td>
	<td>:</td>
	<td><input type="text" class="form-control" id="nama" name="nama" value="<?php echo $nama; ?>"></td>
	</tr>	
	<tr>
	<td>Deskripsi</td>
	<td>:</td>
	<td>
	<textarea style="width:55%" name="deskripsi" rows="3" cols="19"><?php echo $deskripsi; ?></textarea></td>
	</tr>	
	<tr>
	<td></td>
	<td></td>
	<td><input type="submit" class="btn btn-primary" value="Save" name="btnSubmit">
	    <a href="index.php?p=categorylist" class="btn btn-primary">Cancel</a></td>
	</tr>	
	</table>    
</form>	
</div>  
</div>


